<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Which Valorant Agent Are You?</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
    :root{
      --bg:#0e1116; --card:#141823; --text:#e7ecf9; --muted:#9ba3bb; --border:rgba(255,255,255,0.08);
      --accent:#ff4655;           /* static fallback accent */
      --pulse:#ff4655;            /* dynamic, RGB-reactive color set by JS */
      --pulseAlpha:0.35;          /* dynamic intensity 0â€“0.6 */
      --gradStart:#ff4655;        /* dynamic gradient stops */
      --gradEnd:#ff8e53;
    }

    *{box-sizing:border-box}
    body{margin:0;font-family:'Inter',sans-serif;background:radial-gradient(circle at top right,#1a1f2b,#0e1116);color:var(--text);overflow-x:hidden}

    /* animations */
    .fade-in{animation:fadeIn .45s ease forwards;opacity:0}
    @keyframes fadeIn{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}

    .container{max-width:960px;margin:40px auto;padding:0 20px}
    header{text-align:center;margin-bottom:28px}
    header h1{font-size:2rem;font-weight:700;margin:0}
    header p{color:var(--muted);margin-top:8px}

    .quiz-card{background:var(--card);border:1px solid var(--border);border-radius:20px;box-shadow:0 10px 40px rgba(0,0,0,.4), 0 0 24px color-mix(in srgb, var(--pulse) calc(var(--pulseAlpha)*100%), transparent);overflow:hidden;position:relative}

    .quiz-header{display:flex;justify-content:space-between;align-items:center;padding:18px;background:linear-gradient(135deg,var(--gradStart),var(--gradEnd));color:white;position:relative}
    .quiz-header::after{content:"";position:absolute;inset:0;pointer-events:none;box-shadow:0 0 22px 6px color-mix(in srgb, var(--pulse) calc(var(--pulseAlpha)*100%), transparent)}
    .quiz-header h2{margin:0;font-size:1.1rem;letter-spacing:.4px}

    .btn{background:linear-gradient(135deg,var(--gradStart),var(--gradEnd));border:none;border-radius:10px;color:white;font-weight:600;padding:10px 16px;cursor:pointer;transition:.2s transform,.2s filter;box-shadow:0 0 0 1px rgba(255,255,255,.06),0 8px 20px rgba(0,0,0,.35)}
    .btn:hover{transform:translateY(-1px);filter:brightness(1.05)}
    .btn.secondary{background:#0f1422;border:1px solid var(--border);color:var(--text);box-shadow:none}

    .question{padding:22px;border-top:1px solid var(--border);min-height:200px}
    .question h3{margin:0 0 12px;font-size:1.05rem}
    .options{display:grid;gap:12px}
    label.option{display:flex;align-items:center;gap:10px;background:#191d2b;padding:12px;border-radius:12px;cursor:pointer;border:1px solid var(--border);transition:.18s border-color,.18s background, .18s box-shadow}
    label.option:hover{border-color:var(--accent);background:#1f2537;box-shadow:0 0 14px color-mix(in srgb, var(--pulse) 25%, transparent)}
    input[type=radio]{accent-color:var(--accent)}

    .footer{display:flex;justify-content:space-between;gap:10px;padding:16px;border-top:1px solid var(--border)}
    .progress{color:var(--muted);font-size:.95rem}

    .result{padding:24px;text-align:center}
    .agents{display:flex;flex-wrap:wrap;gap:20px;justify-content:center;margin-top:18px}
    .agent-card{background:#191d2b;border:1px solid var(--border);border-radius:14px;overflow:hidden;width:260px;transition:.3s;opacity:0;animation:fadeIn .8s ease .2s forwards;box-shadow:0 0 0 1px rgba(255,255,255,.04), 0 12px 28px rgba(0,0,0,.45)}
    .agent-card:hover{transform:translateY(-3px);box-shadow:0 8px 24px rgba(0,0,0,.5), 0 0 18px color-mix(in srgb, var(--pulse) 30%, transparent)}
    .agent-img{width:100%;height:160px;object-fit:cover}
    .agent-info{padding:14px;text-align:left}
    .agent-info h4{margin:0;font-size:1.1rem}
    .agent-info p{margin:6px 0 0;font-size:.9rem;color:var(--muted)}

    /* end transition */
    #blackFade{position:fixed;inset:0;background:#000;opacity:0;pointer-events:none;transition:opacity 1s ease;z-index:9999}
    #blackFade.on{opacity:1}

    .audio-controls{display:flex;gap:10px;align-items:center}
    .toggle{appearance:none;background:#0f1422;border:1px solid var(--border);color:var(--text);padding:8px 12px;border-radius:10px;cursor:pointer}
  </style>
</head>
<body>
  <div class="container fade-in">
    <header>
      <h1>Which Valorant Agent Are You?</h1>
      <p>Discover your true playstyle. Audioâ€‘reactive RGB pulse enabled.</p>
    </header>

    <div class="quiz-card fade-in" id="quizCard">
      <div class="quiz-header">
        <h2>Agent Personality Quiz</h2>
        <div class="audio-controls">
          <button class="toggle" id="musicToggle" aria-pressed="true">ðŸ”Š Music On</button>
          <button class="btn" id="restartBtn">Restart</button>
        </div>
      </div>

      <div class="question" id="qWrap"></div>
      <div class="footer">
        <span class="progress" id="progress"></span>
        <div style="display:flex;gap:10px">
          <button class="btn secondary" id="prevBtn" type="button">Prev</button>
          <button class="btn" id="nextBtn" type="button">Next</button>
          <button class="btn" id="finishBtn" type="button" style="display:none">Finish</button>
        </div>
      </div>
    </div>

    <div class="result fade-in" id="resultSection" hidden>
      <h2>Your Agent Match</h2>
      <p id="summary"></p>
      <div class="agents" id="agentResults"></div>
    </div>
  </div>

  <div id="blackFade"></div>

  <audio id="bgm" src="zedd_spectrum.mp3" preload="auto" loop></audio>
  <audio id="sfx" src="valorant_ui.mp3" preload="auto"></audio>
  <audio id="resultSfx" src="zedd_final.mp3" preload="auto"></audio>

  <script>
    const QUESTIONS=[
      {q:'Whatâ€™s your role in the squad?',opts:['Duelist','Controller','Initiator','Sentinel']},
      {q:'Your biggest strength?',opts:['Aim & aggression','Strategy & planning','Team coordination','Defense & utility']},
      {q:'Your ideal map control?',opts:['Entry & rush','Mid control','Support & intel','Anchor sites']},
      {q:'Pick your favorite pace:',opts:['Fast','Slow & methodical','Reactive','Balanced']},
      {q:'Your biggest flaw?',opts:['Overheat','Too passive','Overthink','Tunnel vision']},
      {q:'How do you approach clutch situations?',opts:['Go for duels','Use utility smartly','Stay calm and wait','Outthink the enemy']},
      {q:'Preferred environment?',opts:['Urban streets','High-tech lab','Nature/forest','Industrial site']},
      {q:'You value teammates who areâ€¦',opts:['Aggressive','Supportive','Strategic','Reliable']},
      {q:'When under pressure youâ€¦',opts:['Take charge','Stay focused','Adapt','Stay defensive']},
      {q:'Weapon of choice?',opts:['Vandal','Phantom','Operator','Sheriff']},
      {q:'How do you handle mistakes?',opts:['Laugh it off','Analyze and learn','Ignore and move on','Get frustrated but improve']},
      {q:'What motivates you to win?',opts:['Competition','Teamwork','Strategy','Improvement']},
      {q:'Your communication style?',opts:['Short & direct','Calm & steady','Energetic','Silent but effective']},
      {q:'Pick your color palette:',opts:['Red & Black','Blue & Silver','Green & Teal','Purple & Gold']},
      {q:'You play Valorant mostly forâ€¦',opts:['Adrenaline','Tactics','Fun with friends','Mastery']}
    ];

    const AGENTS=[
      {name:'Jett',role:'Duelist',traits:['Fast','Aim & aggression','Entry & rush'],img:'https://static.valorantstats.xyz/agents/jett.jpg'},
      {name:'Raze',role:'Duelist',traits:['Fast','Aim & aggression','Entry & rush'],img:'https://static.valorantstats.xyz/agents/raze.jpg'},
      {name:'Reyna',role:'Duelist',traits:['Fast','Aim & aggression'],img:'https://static.valorantstats.xyz/agents/reyna.jpg'},
      {name:'Omen',role:'Controller',traits:['Slow & methodical','Strategy & planning'],img:'https://static.valorantstats.xyz/agents/omen.jpg'},
      {name:'Brimstone',role:'Controller',traits:['Strategy & planning','Anchor sites'],img:'https://static.valorantstats.xyz/agents/brimstone.jpg'},
      {name:'Viper',role:'Controller',traits:['Strategy & planning','Anchor sites'],img:'https://static.valorantstats.xyz/agents/viper.jpg'},
      {name:'Sova',role:'Initiator',traits:['Support & intel','Team coordination'],img:'https://static.valorantstats.xyz/agents/sova.jpg'},
      {name:'Skye',role:'Initiator',traits:['Team coordination','Support & intel'],img:'https://static.valorantstats.xyz/agents/skye.jpg'},
      {name:'KAY/O',role:'Initiator',traits:['Team coordination','Balanced'],img:'https://static.valorantstats.xyz/agents/kayo.jpg'},
      {name:'Cypher',role:'Sentinel',traits:['Defense & utility','Anchor sites'],img:'https://static.valorantstats.xyz/agents/cypher.jpg'},
      {name:'Killjoy',role:'Sentinel',traits:['Defense & utility','Strategy & planning'],img:'https://static.valorantstats.xyz/agents/killjoy.jpg'},
      {name:'Sage',role:'Sentinel',traits:['Defense & utility','Support & intel'],img:'https://static.valorantstats.xyz/agents/sage.jpg'}
    ];

    const qWrap=document.getElementById('qWrap');
    const progressEl=document.getElementById('progress');
    const prevBtn=document.getElementById('prevBtn');
    const nextBtn=document.getElementById('nextBtn');
    const finishBtn=document.getElementById('finishBtn');
    const resultSection=document.getElementById('resultSection');
    const summary=document.getElementById('summary');
    const agentResults=document.getElementById('agentResults');
    const restartBtn=document.getElementById('restartBtn');
    const musicToggle=document.getElementById('musicToggle');
    const bgm=document.getElementById('bgm');
    const sfx=document.getElementById('sfx');
    const resultSfx=document.getElementById('resultSfx');
    const blackFade=document.getElementById('blackFade');

    let current=0;
    const answers=new Array(QUESTIONS.length).fill(null);

    function renderQuestion(idx){
      const q=QUESTIONS[idx];
      qWrap.classList.remove('fade-in'); void qWrap.offsetWidth; qWrap.classList.add('fade-in');
      qWrap.innerHTML=`<h3>${idx+1}. ${q.q}</h3>`;
      const opts=document.createElement('div'); opts.className='options';
      q.opts.forEach((opt)=>{
        const id=`q${idx}_${opt.replace(/[^a-z0-9]+/gi,'')}`;
        const label=document.createElement('label'); label.className='option';
        const input=document.createElement('input'); input.type='radio'; input.name='q'+idx; input.id=id; input.value=opt;
        if(answers[idx]===opt) input.checked=true;
        input.addEventListener('change',()=>{answers[idx]=opt; playUI(); updateNav();});
        const span=document.createElement('span'); span.textContent=opt;
        label.appendChild(input); label.appendChild(span);
        opts.appendChild(label);
      });
      qWrap.appendChild(opts);
      progressEl.textContent=`Question ${idx+1} of ${QUESTIONS.length}`;
      updateNav();
      document.getElementById('quizCard').scrollIntoView({behavior:'smooth', block:'center'});
    }

    function updateNav(){
      prevBtn.disabled = current===0;
      const hasAnswer = answers[current]!==null;
      nextBtn.disabled = !hasAnswer || current===QUESTIONS.length-1;
      finishBtn.style.display = current===QUESTIONS.length-1 ? 'inline-block' : 'none';
      finishBtn.disabled = !hasAnswer;
    }

    prevBtn.addEventListener('click',()=>{ if(current>0){ current--; playUI(); renderQuestion(current);} });
    nextBtn.addEventListener('click',()=>{ if(current<QUESTIONS.length-1){ current++; playUI(); renderQuestion(current);} });

    finishBtn.addEventListener('click', async ()=>{
      playUI();
      await endSequence();
      const agent = computeResult();
      revealResult(agent);
    });

    function computeResult(){
      let best=null,bestScore=-1;
      answers.forEach(()=>{}); // keep JIT warm
      AGENTS.forEach(agent=>{
        let score=0; answers.forEach(ans=>{ if(agent.traits.includes(ans)) score++; });
        if(score>bestScore){bestScore=score;best=agent;}
      });
      return best || AGENTS[Math.floor(Math.random()*AGENTS.length)];
    }

    function revealResult(agent){
      resultSection.hidden=false;
      summary.textContent=`You match ${agent.name} â€” a ${agent.role} with traits like ${agent.traits.join(', ')}.`;
      agentResults.innerHTML=`<div class='agent-card'><img class='agent-img' src='${agent.img}' alt='${agent.name}'><div class='agent-info'><h4>${agent.name}</h4><p>${agent.role}</p></div></div>`;
      window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'});
    }

    async function endSequence(){
      try{await fadeVolume(0.0,600); bgm.pause();}catch(e){}
      blackFade.classList.add('on');
      await wait(800);
      try{resultSfx.currentTime=0; resultSfx.volume=0.75; await resultSfx.play();}catch(e){}
      await wait(600);
      blackFade.classList.remove('on');
      try{bgm.volume=0.0; await bgm.play(); await fadeVolume(0.4,900);}catch(e){}
    }

    restartBtn.addEventListener('click',()=>{
      for(let i=0;i<answers.length;i++) answers[i]=null;
      current=0; resultSection.hidden=true; renderQuestion(0); playUI();
    });

    /* audio + RGB reactive */
    let audioCtx,analyser,srcNode,freqData; let rafId=null; let hue=0;
    function setupAudio(){ if(audioCtx) return; audioCtx=new(window.AudioContext||window.webkitAudioContext)(); analyser=audioCtx.createAnalyser(); analyser.fftSize=1024; freqData=new Uint8Array(analyser.frequencyBinCount); srcNode=audioCtx.createMediaElementSource(bgm); srcNode.connect(analyser); analyser.connect(audioCtx.destination); }
    function avg(arr,s=0,e=arr.length){ let t=0,c=0; for(let i=s;i<e;i++){t+=arr[i];c++;} return c? t/c : 0; }
    function animatePulse(){ analyser.getByteFrequencyData(freqData); const bass=avg(freqData,0,10); const highs=avg(freqData,40,120); const intensity=Math.min(0.6,(bass/255)*0.6); document.documentElement.style.setProperty('--pulseAlpha',intensity.toFixed(3)); hue=(hue+0.6+highs/1000)%360; const gradA=`hsl(${(hue)%360},90%,58%)`; const gradB=`hsl(${(hue+30)%360},90%,60%)`; document.documentElement.style.setProperty('--pulse',gradA); document.documentElement.style.setProperty('--gradStart',gradA); document.documentElement.style.setProperty('--gradEnd',gradB); rafId=requestAnimationFrame(animatePulse); }
    function startReactive(){ if(!audioCtx) setupAudio(); if(rafId==null) rafId=requestAnimationFrame(animatePulse); }

    function fadeVolume(target=0.4,ms=1200){ const step=16; const delta=(target-bgm.volume)/(ms/step); return new Promise(res=>{ const id=setInterval(()=>{ let v=bgm.volume+delta; if((delta>0 && v>=target) || (delta<0 && v<=target)){ v=target; clearInterval(id);} bgm.volume=Math.max(0,Math.min(1,v)); if(v===target) res(); },step); }); }
    function wait(ms){ return new Promise(r=>setTimeout(r,ms)); }

    async function playMusicAuto(){ try{ setupAudio(); bgm.volume=0.0; await bgm.play(); await fadeVolume(0.4,1500); startReactive(); musicToggle.textContent='ðŸ”Š Music On'; musicToggle.setAttribute('aria-pressed','true'); }catch(e){ musicToggle.textContent='ðŸ”‡ Music Off'; musicToggle.setAttribute('aria-pressed','false'); } }
    musicToggle.addEventListener('click', async ()=>{
      const on = musicToggle.getAttribute('aria-pressed')==='true';
      if(on){ await fadeVolume(0.0,800); bgm.pause(); musicToggle.textContent='ðŸ”‡ Music Off'; musicToggle.setAttribute('aria-pressed','false'); }
      else{ setupAudio(); bgm.volume=0.0; await bgm.play(); await fadeVolume(0.4,1000); startReactive(); musicToggle.textContent='ðŸ”Š Music On'; musicToggle.setAttribute('aria-pressed','true'); }
    });

    function playUI(){ try{ const a=sfx.cloneNode(true); a.volume=0.55; a.play().catch(()=>{}); }catch(e){} }

    renderQuestion(0);
    window.addEventListener('load', playMusicAuto);
    ['click','keydown','touchstart'].forEach(evt=>{
      window.addEventListener(evt, ()=>{
        if(bgm.paused && musicToggle.getAttribute('aria-pressed')!=='true'){
          musicToggle.click();
        }
      }, {once:true});
    });
  </script>
</body>
</html>
